<link href="/css/bootstrap-scroll-modal.css" res="stylesheet">
<!-- Process the devices from the modal -->
<!-- Our device modal --!>
<!-- End --!>
<form action="/job" method="post" enctype="multipart/form-data">
	<div id="deviceModal" class="modal hide">
		<div class="modal-header">
			<a class="close" data-dismiss="modal">&times;</a>
			<h3>Device Selection</h3>
		</div>
		<div class="modal-body">
			<ul id="device_list" style="list-style-type:none;text-decoration:none;">
				<%for device in @devices %>
   <% if device.ip %>
   <% if check_availibility(device.id) == 1 %>	
   <li >
					<input type="checkbox" id="<%=device.tag%>" name="SELECTED_DEVICE=<%=device.id%>" style="margin-top:-5px;"><%=device.name%></input>
					</li>
				<% end %>
				<%end%>
				<%end %>
			</ul>
		</div>
		<div class="modal-footer">
			<input class="btn"id="submit" type="submit" value="submit"/>
		</div>
	</div>
	<% if not @errors.empty? %>
   <div class="errors">
			<p>Validation errors:</p>
			<% @errors.each do |key, value| %>
   <li><%= value %></li>
			<% end %>
		</div>
		<br>
	<% end %>    
	<div class="col-1-3 well"style="height:575px;">
		<h1>New job</h1>

		<h5 style="margin-bottom: 1px;">Job name</h5>
		<input type="text" name="lname" id="lname">
		
		<h5 style="margin-bottom: 1px;">Configuration file</h5>
		<div style="position:relative;">
			<a class='btn' href='javascript:;'>
				Choose File...
				<input type="file" style='position:absolute;z-index:2;top:0;left:0;filter: alpha(opacity=0);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";opacity:0;background-color:transparent;color:transparent;' name="file_source" size="40"  onchange='$("#upload-file-info").html($(this).val().replace("C:\\fakepath\\", ""));'>
			</a>
			&nbsp;
			<span class='label label-info' id="upload-file-info"></span>
		</div>

		<h5 style="margin-bottom: 1px">Trigger time</h5>
		<link rel="stylesheet" type="text/css" media="screen"
		href="/css/bootstrap-datetimepicker.min.css">
		<div id="datetimepicker" class="input-append date">
			<input type="text"  name="ltrigger" id="ltrigger"></input>
			<span class="add-on">
				<i data-time-icon="icon-time" data-date-icon="icon-calendar"></i>
			</span>
		</div>
		<script type="text/javascript"
			src="/js/jquery.min.js">
			</script> 
			<script type="text/javascript"
				src="/js/bootstrap.min.js">
				</script>
				<script type="text/javascript"
					src="/js/bootstrap-datetimepicker.min.js">
					</script>
					<script type="text/javascript">
						$('#datetimepicker').datetimepicker({
format: 'dd/MM/yyyy hh:mm:ss',
pickDate: false
});
jQuery(function($) {
		$('div.btn-group[data-toggle-name=*]').each(function(){
			var group   = $(this);
			var form    = group.parents('form').eq(0);
			var name    = group.attr('data-toggle-name');
			var hidden  = $('input[name="' + name + '"]', form);
			$('button', group).each(function(){
				var button = $(this);
				button.live('click', function(){
					hidden.val($(this).val());
					});
				if(button.val() == hidden.val()) {
				button.addClass('active');
				}
				});
			});

			if ($('#recursive').hasClass("active")) {
				$('#recurrence-div').removeClass('hidden');
			}
		});
</script>
<br />
<div class="btn-group" data-toggle-name="is_private" data-toggle="buttons-radio">
	<button id="single" type="button" value="0" class="btn" data-toggle="button" onclick="hide_recurrence_form();">Single</button>
	<button id="recursive" type="button" value="1" class="btn" data-toggle="button" onclick="show_recurrence_form();">Recursive</button>
</div>
<div class="well hidden" style="margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px;" id="recurrence-div">
	<h6>
		<span>&nbsp;</span>
		<span>Repeats every</span>
		<span>&nbsp;</span>
		<span>
			<input name="seconds_multiplier"style="color: black;width: 20%;font-size: 1em;height: 1.75em;padding-top: 0px;padding-top: 0px;margin-top: 0px;margin-bottom: 0px;" type="number" min="1" id="number-of-time-units" value="1"></input>
		</span>
		<span>&nbsp;</span>
		<span class="controls" >
			<select name="seconds" style="color: black;width: 32%;font-size: 1em;height: 1.75em;padding-top: 0px;padding-top: 0px;margin-top: 0px;margin-bottom: 0px;" name="time-period">
				<option value="60">minutes</option>
				<option value="3600">hours</option>
				<option value="86400" selected>days</option>
			</select>
		</span>
	</h6>
	<small class="pull-right"><em>* minimum interval is 15 minutes.</em></small>
</div>
<br />
<input type="hidden" name="is_private" value="0" />
<h5 style="margin-bottom: 1px;">Main result file name</h5>
<input type="text" name="main_result_file" id="main_result_file" placeholder="cukes.html">

<h5 style="margin-bottom: 1px;">Email reports to</h5>
<input type="text" name="email" id="email">
<div style="margin-top: -7px;"><small><em>* separate multiple emails by a space</em></small></div>
</form>

<h5 style="margin-bottom: 1px;">Select devices</h5>
<a class="btn btn-info" data-dynamic="true" data-backdrop="false" data-toggle="modal" href="#deviceModal">Device selection</a>
</div>

<div class="col-1-3 well" style="margin-top:-15px;height:575px;">
	<h2>Environmental variables</h2>
	<span>The following are variables you can put into your script and will be automatically resolved for the correct entry</span>
	<h4>IP addresses</h4>
	<p>$PHONE_ENDPOINT</p>
	<p>$PAD_ENDPOINT</p>
	<h4>Serial address</h4>
	<p>$PHONE_SERIAL</p>
	<p>$PAD_SERIAL</p>
	<span>e.g. "DEVICE_ENDPOINT=http://$PHONE_ENDPOINT cucumber"</span>
</div>
<script src="/js/bootstrap-scroll-modal.js"></script>
<script src="/js/bootstrap-transition.js"></script>
<script type="text/javascript">
	function show_recurrence_form() {
		$('#recurrence-div').removeClass("hidden");
	}

	function hide_recurrence_form() {
		$('#recurrence-div').addClass("hidden");
	}
</script>
